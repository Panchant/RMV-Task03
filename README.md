

# R标及锤子的识别

**思路:** 对R标和锤子进行模板匹配，得到坐标，再绘制圆圈。

**遇到的问题与解决方案：**
- 1、R标可以用模板匹配matchtemplate实现，但是在应用到锤子上时就不再适用，效果较差
	- 解决方案：matchtemplate只适用于平移，对于这种旋转的图像只有在固定角度才能识别。使用轮廓及轮廓特征，对锤子的面积进行锁定
- 2、应用轮廓过程中，发现最后没有识别出锤子
	- 解决方案：发现是二值化区间有问题，导致template是白底黑字，findcontour无法识别
- 3、在修改代码之后，发现识别的效果比较差
	- 解决方案：使用旋转模板匹配，匹配的效果好
- 4、发现旋转模板匹配效率及其低下，会导致后面数据拟合非常慢
	- 解决方案：使用ORB特征检测器
- 5、锤子和风车之间的差别并不大，导致ORB特征检测样本数很少，甚至分辨不出哪个是锤子哪个是风车
	- 解决方案：再次使用轮廓特征中的面积作差进行识别，并画出了轮廓，效果非常好，几乎达到了完美贴合的效果

**ORB匹配图：**
![9a49115045bf1d960b2dfe191fb95511.png](https://ice.frostsky.com/2024/10/05/9a49115045bf1d960b2dfe191fb95511.png)

**面积轮廓匹配图：**
![54ca39e2e6473cddebc61bd1c2609bf4.png](https://ice.frostsky.com/2024/10/05/54ca39e2e6473cddebc61bd1c2609bf4.png)

**最终效果图：**
![593ccc031fd9b499048baade44af5606.png](https://ice.frostsky.com/2024/10/05/593ccc031fd9b499048baade44af5606.png)

---
# 风车数据拟合

**思路：** 我们在第一步绘图中得到了坐标，现在需要根据这些数据与风车转速公式开始计算预测，创建公式

**遇到的问题与解决方案：**
- 1、运行过程中数据呈现的太慢，2～3s才出来一个坐标信息
	- 解决方案：更改识别代码，通过轮廓特征面积进行识别，效率得到了极大的改善
- 2、用转速公式`A\cos{(\omega t + \phi)} + b`构建残差方程，发现很难构建原函数与之匹配，而且最终计算得到精度低
	- 解决方案：通过角度的变化`dangle = A0 * dt + (A / w) * (cos(w * t0 + 1.81) - cos(w * (t0 + dt) + 1.81));`构建残差方程，就可以省去很多步骤，并且直接计算得到数据
- 3、重新运行程序，发现数据呈现的非常大，并且毫无规律
	- 解决方案：对参数进行进行边界限制
- 4、运行程序发现数据就卡在边界值*例：我设置A边界为(0.5，5)，A就一直卡在5不会动*，不会再更新
	- 解决方案：通过一次次的排查，发现问题出现在对时间dt的处理上，经过修改，程序得以继续运行
- 5、程序在拟合过程中，明明已经达到拟合的条件，却还在不停地刷新
	- 解决方案：对循环的次数条件作了错误的迭代(应该是每次成功运行run+1，写成了若不成功run--)

最终得以成功拟合数据

---
# 附加说明

在README.md所涉及的问题只是调试中卡我比较久的部分，实际上还有各种大大小小的问题卡着我，所以直到最后两天才完成了Task03，但总归是有惊无险的完成了这次任务。最终还有一个小问题，就是最终迭代的平均时间显示有bug，在我的电脑上显示0.02...s，但是检查了很多遍也没找到问题发生在哪里（

**附上我GPT使用记录：**
![2073ebb3e7833bad13261db345947afc.png](https://ice.frostsky.com/2024/10/05/2073ebb3e7833bad13261db345947afc.png)


# 参考

[面向初学者的 OpenCV-Python 教程](https://codec.wang/docs/opencv/)  
[RoboMaster能量机关识别的简易实现](https://blog.csdn.net/qq_45742471/article/details/105183884)  
[openCV-python模板匹配（旋转）](https://blog.csdn.net/weixin_43737866/article/details/129385985)  
[使用Clangd提升C++代码编写体验](https://www.sohu.com/a/588745673_100093134)  
[能量机关识别与预测](https://xjtu-rmv.github.io/%E4%BB%BB%E5%8A%A1%E4%B9%A6/Windmill.html)  
